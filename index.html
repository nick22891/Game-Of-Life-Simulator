<html>

<head>

<title>Game of Life</title>

</head>

<body>

<script>

function BlockGrid (w, h) {

	this.width = w;
	
	this.height = h;
	
	this.grid = new Array();//this stores the current state of the game board
	
	this.bufferGrid = new Array();//this will temporarily store the state of each new iteration
	
	for (var row = 0; row < this.height;row++) { //initializes an array for each row based on the height given
	
		this.grid[row] = [];
		
		for (var col = 0; col < this.width;col++) { //sets the column index for each row based on the width given
		
			this.grid[row][col] = false; //every grid square defaults to false
		
		}
		
	} 
	
    this.toggle = function(row, col) {
        this.grid[row][col] = !this.grid[row][col];//this switches the state of the square passed into the function
    }
    
    this.output = function() {//this lets me use an alert box for the time being to crudely show the contents of my grid
    
    	var outputtext = "";
    
    	for (var row = 0; row < this.height;row++) {
		
			for (var col = 0; col < this.width;col++) {
		
				outputtext += this.grid[row][col] + " ";
		
			}
			
			outputtext += "\n";//line break after each row
		
		} 
		
		return outputtext;//passes the string back to the alert function
    
    }
    
    this.checkIfSquareIsAlive = function (row, col) {
    
    	var alive = false;//sets state to dead until life can be determined
    
    	if (row >= 0 && row < this.height && col < this.width && col >= 0) { //check that this square is not off the map
    	
    		alive = this.grid[row][col];
    	
    	}
    	
    	return alive;
    
    }
    
    this.run = function () {
    
    	for (var row = 0; row < this.height;row++) { //initializes an array for each row based on the height given
	
			this.bufferGrid[row] = [];
		
			for (var col = 0; col < this.width;col++) { //sets the column index for each row based on the width given
			
				var liveAdjacentSquares = 0;//Will accumulate the number of live adjacent squares
				
				for (var r = row-1; r <= row+1; r++) {//this little bit of sorcery will scan the 3x3 grid surrounding the square
				
					for (var c = col-1; c <= col+1;c++) {//hopefully this isn't too confusing - it starts at the top left and scans each row
				
						if (row != r || col != c) {//quickly check that we're not counting the square we're on since right now we only want the 8 surrounding cells
						
							if (this.checkIfSquareIsAlive(r, c)) liveAdjacentSquares++;
						
						}
				
					}
				
				}
				
				if (this.grid[row][col]) {//if this square is alive
				
					if (liveAdjacentSquares < 2 || liveAdjacentSquares > 3) this.bufferGrid[row][col] = false;//this square dies
					
					else this.bufferGrid[row][col] = true;//this square lives
				
				}
				
				else {//if this square is dead
				
					if (liveAdjacentSquares == 3) this.bufferGrid[row][col] = true;//this square becomes a live cell
					
					else this.bufferGrid[row][col] = false;//it stays dead
				
				}
		
			}
		
		} 
  
  		this.grid = this.bufferGrid.slice();
  
    }

}

var grid = new BlockGrid(5, 5); //create a test 2 x 2 grid

grid.toggle(2,1);//

grid.toggle(2,2);//

grid.toggle(2,3); //now these three toggles will create horizontal line 

alert(grid.output()); //outputs the state of the grid (temporary until I set up the proper visual display)

grid.run();//the horizontal line will switch to vertical after run() is executed (which means so far so good) - time for another nap ^.^

alert(grid.output());

grid.run();//the vertical line will switch back to horizontal after run() is executed (which means so far so good) - time for another nap ^.^

alert(grid.output());

</script>

</body>

</html>

